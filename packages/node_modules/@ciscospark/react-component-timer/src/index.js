/* eslint-disable react/no-set-state, react/no-did-mount-set-state, react/require-optimization */
import React, {PropTypes, Component} from 'react';
import classNames from 'classnames';
import moment from 'moment';

export default class Timer extends Component {
  componentDidMount() {
    clearInterval(this.interval);
    if (this.props.startTime) {
      this.interval = setInterval(this.forceUpdate.bind(this), 1000);
    }
  }

  componentWillUnmount() {
    clearInterval(this.interval);
  }

  render() {
    if (!this.props.startTime) {
      return false;
    }
    const elapsed = Date.now() - this.props.startTime;
    let timeFormat = `mm:ss`;
    if (elapsed > 1000 * 3600) {
      timeFormat = `hh:mm:ss`;
    }
    return (
      <div className={classNames(`timer`)}>{moment.utc(elapsed).format(timeFormat)}</div>
    );
  }
}

Timer.propTypes = {
  startTime: PropTypes.number.isRequired
};
