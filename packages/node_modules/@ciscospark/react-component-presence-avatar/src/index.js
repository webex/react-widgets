import React from 'react';
import PropTypes from 'prop-types';
import classNames from 'classnames';

import Avatar from '@ciscospark/react-component-avatar';
import Icon, {ICON_TYPE_DND, ICON_TYPE_PTO} from '@ciscospark/react-component-icon';
import {
  PRESENCE_TYPE_ACTIVE,
  PRESENCE_TYPE_INACTIVE,
  PRESENCE_TYPE_DND,
  PRESENCE_TYPE_OOO
} from '@ciscospark/redux-module-presence';

import styles from './styles.css';

const propTypes = {
  iconSize: PropTypes.string,
  isSelfAvatar: PropTypes.bool,
  presenceStatus: PropTypes.string
};

const defaultProps = {
  iconSize: '24px',
  isSelfAvatar: false,
  presenceStatus: undefined
};

function PresenceAvatar(props) {
  const {
    iconSize,
    isSelfAvatar,
    presenceStatus
  } = props;
  let icon;
  const avatarClasses = ['ciscospark-presence-avatar', styles.avatar];
  // Do not show presence on self avatars
  if (!isSelfAvatar) {
    switch (presenceStatus) {
      case PRESENCE_TYPE_ACTIVE:
        avatarClasses.push('ciscospark-presence-avatar-active');
        avatarClasses.push(styles.active);
        break;
      case PRESENCE_TYPE_INACTIVE:
        avatarClasses.push('ciscospark-presence-avatar-inactive');
        avatarClasses.push(styles.inactive);
        break;
      case PRESENCE_TYPE_OOO:
        avatarClasses.push('ciscospark-presence-avatar-ooo');
        avatarClasses.push(styles.ooo);
        icon = <Icon type={ICON_TYPE_PTO} />;
        break;
      case PRESENCE_TYPE_DND:
        avatarClasses.push('ciscospark-presence-avatar-dnd');
        avatarClasses.push(styles.dnd);
        icon = <Icon type={ICON_TYPE_DND} />;
        break;
      default:
    }
  }

  return (
    <div className={classNames(avatarClasses)}>
      {icon &&
        <div className={classNames('ciscospark-presence-avatar-icon-container', styles.iconContainer)} >
          <div
            className={classNames('ciscospark-presence-avatar-icon', styles.icon)}
            style={{fontSize: iconSize}}
          >
            {icon}
          </div>
          <div className={classNames('ciscospark-presence-avatar-icon-underlay', styles.iconUnderlay)} />
        </div>
      }
      <Avatar {...props} />
    </div>
  );
}

PresenceAvatar.propTypes = propTypes;
PresenceAvatar.defaultProps = defaultProps;

export default PresenceAvatar;
